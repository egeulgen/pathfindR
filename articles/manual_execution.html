<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Step-by-Step Execution of the pathfindR Enrichment Workflow • pathfindR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Step-by-Step Execution of the pathfindR Enrichment Workflow">
<meta property="og:description" content="pathfindR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pathfindR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/comparing_results.html">Comparing Two pathfindR Results</a>
    </li>
    <li>
      <a href="../articles/intro_vignette.html">Introduction to pathfindR</a>
    </li>
    <li>
      <a href="../articles/manual_execution.html">Step-by-Step Execution of the pathfindR Enrichment Workflow</a>
    </li>
    <li>
      <a href="../articles/non_hs_analysis.html">pathfindR Analysis for non-Homo-sapiens organisms</a>
    </li>
    <li>
      <a href="../articles/obtain_data.html">Obtaining PIN and Gene Sets Data</a>
    </li>
    <li>
      <a href="../articles/visualization_vignette.html">Visualization of pathfindR Enrichment Results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egeulgen/pathfindR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Step-by-Step Execution of the pathfindR Enrichment Workflow</h1>
                        <h4 class="author">Ege Ulgen</h4>
            
            <h4 class="date">2020-05-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/egeulgen/pathfindR/blob/master/vignettes/manual_execution.Rmd"><code>vignettes/manual_execution.Rmd</code></a></small>
      <div class="hidden name"><code>manual_execution.Rmd</code></div>

    </div>

    
    
<p>This vignette walks through each step of the pathfindR active-subnetwork-oriented pathway enrichment analysis. For most purposes, the wrapper function <code><a href="../reference/run_pathfindr.html">run_pathfindR()</a></code> can be used to perform this analysis from start to end. For users who wish to have further control over the enrichment workflow, this vignette will be more useful.</p>
<p><img src="pathfindr.png" style="max-width:100%;"></p>
<div id="load-the-package-and-prepare-the-input-data-frame" class="section level1">
<h1 class="hasAnchor">
<a href="#load-the-package-and-prepare-the-input-data-frame" class="anchor"></a>Load the package and prepare the input data frame</h1>
<p>We first need to load the package and the input data to be used for analysis. The input must be a data frame consisting of the following columns: <code>Gene Symbols</code>, <code>Change Values</code> (optional) and <code>p values</code>. The example data frame used in this vignette (<code>RA_input</code>) is the dataset containing the differentially-expressed genes for the GEO dataset GSE15573 comparing 18 rheumatoid arthritis (RA) patients versus 15 healthy subjects.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pathfindR</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">RA_input</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">RA_input</span>, <span class="fl">3</span>)
<span class="co">#&gt;   Gene.symbol      logFC    adj.P.Val</span>
<span class="co">#&gt; 1     FAM110A -0.6939359 3.408699e-06</span>
<span class="co">#&gt; 2      RNASE2  1.3535040 1.008499e-05</span>
<span class="co">#&gt; 3      S100A8  1.5448338 3.466386e-05</span></pre></body></html></div>
</div>
<div id="the-protein-protein-interaction-network-pin" class="section level1">
<h1 class="hasAnchor">
<a href="#the-protein-protein-interaction-network-pin" class="anchor"></a>The protein-protein interaction network (PIN)</h1>
<p>For the active subnetwork search process, we will need a protein-protein interaction network (PIN). pathfindR will map the input genes onto this PIN and identify active subnetworks which will then be used for enrichment analyses.</p>
<blockquote>
<p>An active subnetwork can be defined as a group of interconnected genes in a protein-protein interaction network (PIN) that predominantly consists of significantly altered genes. In other words, active subnetworks define distinct disease-associated sets of interacting genes, whether discovered through the original analysis or discovered because of being in interaction with a significant gene.</p>
</blockquote>
<p>The <code>pin_name_path</code> argument in all functions can be one of “Biogrid”, “STRING”, “GeneMania”, “IntAct”, “KEGG”, “mmu_STRING” or it can be the path to a custom PIN file provided by the user.</p>
</div>
<div id="process-input-data" class="section level1">
<h1 class="hasAnchor">
<a href="#process-input-data" class="anchor"></a>Process input data</h1>
<p>We next need to process the input data for use in analysis via <code><a href="../reference/input_processing.html">input_processing()</a></code>:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">RA_processed</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/input_processing.html">input_processing</a></span>(<span class="kw">input</span> <span class="kw">=</span> <span class="no">RA_input</span>, <span class="co"># the input: in this case, differential expression results</span>
                                 <span class="kw">p_val_threshold</span> <span class="kw">=</span> <span class="fl">0.05</span>, <span class="co"># p value threshold to filter significant genes</span>
                                 <span class="kw">pin_name_path</span>  <span class="kw">=</span> <span class="st">"Biogrid"</span>, <span class="co"># the name of the PIN to use for active subnetwork search</span>
                                 <span class="kw">convert2alias</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="co"># boolean indicating whether or not to convert missing symbols to alias symbols in the PIN</span>
<span class="co">#&gt; Number of genes provided in input: 572</span>
<span class="co">#&gt; Number of genes in input after p-value filtering: 572</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Could not find any interactions for 11 (1.92%) genes in the PIN</span>
<span class="co">#&gt; Final number of genes in input: 561</span></pre></body></html></div>
<blockquote>
<p>After checking that the data frame complies with the requirements, <code><a href="../reference/input_processing.html">input_processing()</a></code> filters the input so that genes with p values larger than <code>p_val_threshold</code> are excluded. Next, gene symbols that are not in the PIN are identified and excluded. For human genes, if aliases of these missing gene symbols are found in the PIN, these symbols are converted to the corresponding aliases (controlled by the argument <code>convert2alias</code>). This step is performed to best map the input data onto the PIN.</p>
</blockquote>
</div>
<div id="obtain-gene-set-data" class="section level1">
<h1 class="hasAnchor">
<a href="#obtain-gene-set-data" class="anchor"></a>Obtain Gene Set Data</h1>
<p>We obtain the necessary gene sets for enrichment analyses using <code><a href="../reference/fetch_gene_set.html">fetch_gene_set()</a></code>:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># using "BioCarta" as our gene sets for enrichment</span>
<span class="no">biocarta_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fetch_gene_set.html">fetch_gene_set</a></span>(<span class="kw">gene_sets</span> <span class="kw">=</span> <span class="st">"BioCarta"</span>,
                                <span class="kw">min_gset_size</span> <span class="kw">=</span> <span class="fl">10</span>,
                                <span class="kw">max_gset_size</span> <span class="kw">=</span> <span class="fl">300</span>)
<span class="no">biocarta_gsets</span> <span class="kw">&lt;-</span> <span class="no">biocarta_list</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="no">biocarta_descriptions</span> <span class="kw">&lt;-</span> <span class="no">biocarta_list</span><span class="kw">[[</span><span class="fl">2</span>]]</pre></body></html></div>
<blockquote>
<p>The available gene sets in pathfindR are “KEGG”, “Reactome”, “BioCarta”, “GO-All”, “GO-BP”, “GO-CC” and “GO-MF”. If the user prefers to use another gene set source, the <code>gene_sets</code> argument should be set to <code>"Custom"</code> and the custom gene sets (list) and the custom gene set descriptions (named vector) should be supplied via the arguments <code>custom_genes</code> and <code>custom_descriptions</code>, respectively. See <code><a href="../reference/fetch_gene_set.html">?fetch_gene_set</a></code> for more details.</p>
</blockquote>
</div>
<div id="active-subnetwork-search-and-enrichment-analyses" class="section level1">
<h1 class="hasAnchor">
<a href="#active-subnetwork-search-and-enrichment-analyses" class="anchor"></a>Active Subnetwork Search and Enrichment Analyses</h1>
<p>As outlined in the vignette <a href="intro_vignette.html">Introduction to pathfindR</a>, <code><a href="../reference/run_pathfindr.html">run_pathfindR()</a></code> initially identifies and filters active subnetworks, then performs enrichment analyses on these subnetworks and summarize the results.</p>
<p>To perform these steps manually, we utilize the function <code><a href="../reference/active_snw_search.html">active_snw_search()</a></code> for identifying and filtering active subnetworks and the function <code><a href="../reference/enrichment_analyses.html">enrichment_analyses()</a></code> for obtaining enriched terms using these subnetworks. Because the active subnetwork search algorithms are stochastic, we suggest iterating these subnetwork identification and enrichment steps multiple times <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">n_iter</span> <span class="kw">&lt;-</span> <span class="fl">15</span> <span class="co">## number of iterations</span>
<span class="no">combined_res</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span> <span class="co">## to store the result of each iteration</span>

<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">n_iter</span>) {

  <span class="co">###### Active Subnetwork Search</span>
  <span class="no">snws_file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"active_snws_"</span>, <span class="no">i</span>) <span class="co"># Name of output file</span>
  <span class="no">active_snws</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/active_snw_search.html">active_snw_search</a></span>(<span class="kw">input_for_search</span> <span class="kw">=</span> <span class="no">RA_processed</span>,
                                   <span class="kw">pin_name_path</span> <span class="kw">=</span> <span class="st">"Biogrid"</span>,
                                   <span class="kw">snws_file</span> <span class="kw">=</span> <span class="no">snws_file</span>,
                                   <span class="kw">score_quan_thr</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="co"># you may tweak these arguments for optimal filtering of subnetworks</span>
                                   <span class="kw">sig_gene_thr</span> <span class="kw">=</span> <span class="fl">0.02</span>, <span class="co"># you may tweak these arguments for optimal filtering of subnetworks</span>
                                   <span class="kw">search_method</span> <span class="kw">=</span> <span class="st">"GR"</span>)

  <span class="co">###### Enrichment Analyses</span>
  <span class="no">current_res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/enrichment_analyses.html">enrichment_analyses</a></span>(<span class="kw">snws</span> <span class="kw">=</span> <span class="no">active_snws</span>,
                                     <span class="kw">input_genes</span> <span class="kw">=</span> <span class="no">RA_processed</span>$<span class="no">GENE</span>,
                                     <span class="kw">pin_name_path</span> <span class="kw">=</span> <span class="st">"Biogrid"</span>,
                                     <span class="kw">genes_by_term</span> <span class="kw">=</span> <span class="no">biocarta_gsets</span>,
                                     <span class="kw">term_descriptions</span> <span class="kw">=</span> <span class="no">biocarta_descriptions</span>,
                                     <span class="kw">adj_method</span> <span class="kw">=</span> <span class="st">"bonferroni"</span>,
                                     <span class="kw">enrichment_threshold</span> <span class="kw">=</span> <span class="fl">0.05</span>,
                                     <span class="kw">list_active_snw_genes</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="co"># listing the non-input active snw genes in output</span>

  <span class="co">###### Combine results via `rbind`</span>
  <span class="no">combined_res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">combined_res</span>, <span class="no">current_res</span>)
}</pre></body></html></div>
</div>
<div id="summary-of-enrichment-results" class="section level1">
<h1 class="hasAnchor">
<a href="#summary-of-enrichment-results" class="anchor"></a>Summary of Enrichment Results</h1>
<p>We next summarize the enrichment results (in <code>combined_res</code>) using <code><a href="../reference/summarize_enrichment_results.html">summarize_enrichment_results()</a></code> and annotate the involved significant (input) genes in each term using <code><a href="../reference/annotate_term_genes.html">annotate_term_genes()</a></code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">###### Summarize Combined Enrichment Results</span>
<span class="no">summarized_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/summarize_enrichment_results.html">summarize_enrichment_results</a></span>(<span class="no">combined_res</span>,
                                              <span class="kw">list_active_snw_genes</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co">###### Annotate Affected Genes Involved in Each Enriched Term</span>
<span class="no">final_res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/annotate_term_genes.html">annotate_term_genes</a></span>(<span class="kw">result_df</span> <span class="kw">=</span> <span class="no">summarized_df</span>,
                                 <span class="kw">input_processed</span> <span class="kw">=</span> <span class="no">RA_processed</span>,
                                 <span class="kw">genes_by_term</span> <span class="kw">=</span> <span class="no">biocarta_gsets</span>)</pre></body></html></div>
</div>
<div id="visualizations" class="section level1">
<h1 class="hasAnchor">
<a href="#visualizations" class="anchor"></a>Visualizations</h1>
<p>We can visualize each enriched term diagram using <code><a href="../reference/visualize_terms.html">visualize_terms()</a></code>. In this case, these will be graphs of interactions of pathway-involved genes for each pathway. See <code><a href="../reference/visualize_terms.html">?visualize_terms</a></code> for more details.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/visualize_terms.html">visualize_terms</a></span>(<span class="kw">result_df</span> <span class="kw">=</span> <span class="no">final_res</span>,
                <span class="kw">hsa_KEGG</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="co"># boolean to indicate whether human KEGG gene sets were used for enrichment analysis or not</span>
                <span class="kw">pin_name_path</span> <span class="kw">=</span> <span class="st">"Biogrid"</span>)</pre></body></html></div>
<p><img src="example_interaction_vis.png" style="max-width:100%;"></p>
<p>We can also create a graphical summary of the top 10 enrichment results using <code><a href="../reference/enrichment_chart.html">enrichment_chart()</a></code>:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/enrichment_chart.html">enrichment_chart</a></span>(<span class="no">final_res</span>[<span class="fl">1</span>:<span class="fl">10</span>, ])</pre></body></html></div>
<p><img src="man_enrichment_chart.png" style="max-width:100%;"></p>
<p>The x-axis corresponds to fold enrichment values while the y-axis indicates the enriched terms. The size of each bubble indicates the number of significant genes in the given enriched term. Color indicates the -log10(lowest-p) value. The closer the color is to red, the more significant the enrichment is.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Here we are using a regular <code>for</code> loop. In the wrapper function <code><a href="../reference/run_pathfindr.html">run_pathfindR()</a></code>, however, a parallel loop (via the package <code>foreach</code>) is used.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ege Ulgen, Ozan Ozisik.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '7f13d388d59fea08d4add29291ea2896',
    indexName: 'pathfindr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
